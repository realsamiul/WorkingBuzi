<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>Venturi Space | Mission Control</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;600&family=Rajdhani:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        :root {
            --black: 4, 4, 4;
            --body: 4, 4, 4;
            --text: 244, 244, 244;
            --white: 255, 255, 255;
            --orange: 255, 53, 9;
            --grey: 26, 26, 26;
            --ease: cubic-bezier(0.25, 0, 0.25, 1);
            --font-display: 'Barlow', sans-serif;
            --font-tech: 'Rajdhani', sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: rgb(var(--body));
            color: rgb(var(--text));
            overflow-x: hidden;
            font-family: var(--font-display);
            -webkit-font-smoothing: antialiased;
            overflow-y: auto;
            height: 100%;
        }

        [c-font*="yell_1"] {
            font-family: var(--font-tech);
            font-size: clamp(3rem, 8vw, 12.5rem);
            line-height: 0.9;
            font-weight: 700;
            text-transform: uppercase;
        }
        
        [c-font*="title_2"] {
            font-family: var(--font-tech);
            font-size: clamp(2rem, 5vw, 5.5rem);
            line-height: 0.96;
            text-transform: uppercase;
            font-weight: 600;
        }

        [c-font*="body_3"] {
            font-size: 1.3rem;
            line-height: 1.25;
        }

        /* Preloader */
        .loader {
            position: fixed;
            inset: 0;
            z-index: 200;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
            background: rgb(var(--body));
        }

        .loader-fill {
            position: fixed;
            inset: 0;
            background: rgb(var(--body));
            transition: transform 1s var(--ease);
            transform-origin: top;
        }

        .loader-data {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            transition: opacity 0.5s var(--ease);
        }

        .loader.hidden {
            pointer-events: none;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.5s var(--ease), visibility 0.5s;
        }

        .loader.hidden .loader-fill { 
            transform: scaleY(0); 
        }
        .loader.hidden .loader-data { 
            opacity: 0; 
        }

        .loader-status {
            font-family: var(--font-tech);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 1.5em;
            overflow: hidden;
        }

        .loader-status span {
            display: block;
            transition: transform 0.5s var(--ease);
        }

        .loader-status.launching .loader-prepare { transform: translateY(-100%); }
        .loader-status.launching .loader-ready { transform: translateY(-100%); }

        .loader-countdown {
            display: flex;
            align-items: center;
            font-family: var(--font-tech);
            font-variant-numeric: tabular-nums;
        }

        .loader-bars {
            width: 3.9rem;
            margin-right: 1rem;
        }

        .loader-bars rect {
            fill: rgba(255, 255, 255, 0.5);
            animation: pulse 2s steps(3) infinite;
        }
        .loader-bars rect:nth-child(1) { animation-delay: 0.23s; }
        .loader-bars rect:nth-child(2) { animation-delay: 0.46s; }
        .loader-bars rect:nth-child(3) { animation-delay: 0.69s; }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.2; }
        }

        /* Globe Container */
        #globe-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1;
            opacity: 0;
            transition: opacity 2s var(--ease);
            pointer-events: none;
        }

        /* Scroll Sections */
        .scroll-container {
            position: relative;
            z-index: 10;
            min-height: 600vh;
        }

        .section {
            height: 100vh;
            display: flex;
            align-items: center;
            padding: 0 10%;
            position: relative;
            pointer-events: none;
            position: sticky;
            top: 0;
        }

        .content-box {
            max-width: 60rem;
            pointer-events: auto;
            transform: translateY(50px);
            opacity: 0;
            transition: all 1s var(--ease);
        }
        
        .section.active .content-box {
            opacity: 1;
            transform: translateY(0);
        }

        .label {
            color: rgb(var(--orange));
            border: 1px solid rgb(var(--orange));
            padding: 0.5rem 1rem;
            display: inline-block;
            margin-bottom: 2rem;
            font-family: var(--font-tech);
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 0.1em;
        }

        p { 
            opacity: 0.7; 
            max-width: 40ch; 
            margin-top: 1rem; 
            font-size: 1.1rem; 
            line-height: 1.5; 
        }

        /* HUD */
        .coords-hud {
            position: fixed;
            bottom: 3rem;
            right: 3rem;
            text-align: right;
            font-family: var(--font-tech);
            z-index: 20;
            opacity: 0;
            transition: opacity 1s var(--ease);
            pointer-events: none;
        }
        .coords-hud h4 { 
            color: rgb(var(--orange)); 
            text-transform: uppercase; 
            letter-spacing: 2px; 
            font-size: 0.8rem; 
            margin: 0 0 0.5rem 0;
        }
        .coords-hud span { 
            font-size: 2rem; 
            font-weight: 600; 
            display: block; 
        }

        /* Mission Stats */
        .mission-stats {
            position: fixed;
            top: 3rem;
            left: 3rem;
            font-family: var(--font-tech);
            z-index: 20;
            opacity: 0;
            transition: opacity 1s var(--ease);
            pointer-events: none;
        }
        .mission-stats.visible { 
            opacity: 1; 
        }
        .stat-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }
        .stat-dot {
            width: 8px;
            height: 8px;
            background: rgb(var(--orange));
            border-radius: 50%;
            animation: blink 2s infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .scroll-indicator {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            z-index: 20;
            color: rgb(var(--orange));
            font-family: var(--font-tech);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 1s var(--ease);
            pointer-events: none;
        }

        .scroll-indicator.visible {
            opacity: 0.7;
        }
    </style>

    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    
    <!-- Globe.gl -->
    <script src="https://unpkg.com/globe.gl"></script>
    <!-- THREE.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>

    <!-- PRELOADER -->
    <div class="loader" id="loader">
        <div class="loader-fill"></div>
        <div class="loader-data">
            <svg class="asset loader-logo" width="200" height="40" viewBox="0 0 200 40" xmlns="http://www.w3.org/2000/svg">
                <path d="M10,10 L30,30 L50,10" fill="none" stroke="white" stroke-width="4"/>
                <text x="60" y="28" fill="white" font-family="Rajdhani" font-size="18" font-weight="600">VENTURI SPACE</text>
            </svg>
            
            <div class="loader-status" id="loaderStatus">
                <span class="loader-prepare" c-font="body_3">Ready for launch</span>
                <span class="loader-ready" c-font="body_3">Take-off</span>
            </div>
            
            <div class="loader-countdown">
                <svg class="asset loader-bars" width="39" height="10" viewBox="0 0 39 10" fill="none">
                    <rect opacity="0.2" width="1" height="10" x="38" fill="#D9D9D9"></rect>
                    <rect opacity="0.6" width="1" height="10" x="22" fill="#D9D9D9"></rect>
                    <rect opacity="0.3" width="2" height="10" x="26" fill="#D9D9D9"></rect>
                    <rect opacity="0.8" width="3" height="10" x="8" fill="#D9D9D9"></rect>
                    <rect opacity="0.1" width="4" height="10" x="34" fill="#D9D9D9"></rect>
                </svg>
                <span class="loader-time" id="loaderTime">00:10:00</span>
            </div>
        </div>
    </div>

    <!-- GLOBE CONTAINER -->
    <div id="globe-container"></div>

    <!-- SCROLL INDICATOR -->
    <div class="scroll-indicator" id="scrollIndicator">Scroll to explore mission</div>

    <!-- MISSION STATS HUD -->
    <div class="mission-stats" id="mission-stats">
        <div class="stat-item">
            <span class="stat-dot"></span>
            <span>MISSION: ACTIVE</span>
        </div>
        <div class="stat-item">
            <span class="stat-dot" style="animation-delay: 0.5s;"></span>
            <span id="altitude-display">ALT: 400 KM</span>
        </div>
        <div class="stat-item">
            <span class="stat-dot" style="animation-delay: 1s;"></span>
            <span id="velocity-display">VEL: 7.66 KM/S</span>
        </div>
    </div>

    <!-- COORDS HUD -->
    <div class="coords-hud" id="hud">
        <h4>Target Coordinates</h4>
        <span id="coord-display">00°00'00" N</span>
    </div>

    <!-- SCROLL CONTENT -->
    <div class="scroll-container">
        
        <section class="section" id="sec-1">
            <div class="content-box">
                <span class="label">Phase 01</span>
                <h1 c-font="yell_1">Orbital<br>Injection</h1>
                <p>The Sentinel satellite stabilizes in high Earth orbit. Systems diagnostic complete. Establishing downlink.</p>
            </div>
        </section>

        <section class="section" id="sec-2">
            <div class="content-box" style="margin-left: auto; text-align: right;">
                <span class="label">Phase 02</span>
                <h2 c-font="title_2">Earth Observation</h2>
                <p>Visual confirmation of the Blue Marble. Atmospheric sensors active. Preparing for data overlay.</p>
            </div>
        </section>

        <section class="section" id="sec-3">
            <div class="content-box">
                <span class="label">Analysis</span>
                <h2 c-font="title_2">Population Density</h2>
                <p>Hex-bin aggregation reveals human activity clusters. Thermal signatures correlate with energy consumption.</p>
            </div>
        </section>

        <section class="section" id="sec-4">
            <div class="content-box" style="margin-left: auto;">
                <span class="label">Target Acquired</span>
                <h1 c-font="title_2">Dhaka, Bangladesh</h1>
                <p>Precision coordinates locked. High-resolution scanning initiated at 23.68° N, 90.35° E.</p>
            </div>
        </section>

        <section class="section" id="sec-5">
            <div class="content-box">
                <span class="label">Phase 03</span>
                <h2 c-font="title_2">Lunar Transfer</h2>
                <p>Leaving Earth orbit. Calculating trajectory for lunar injection. Destination: South Pole-Aitken basin.</p>
            </div>
        </section>

        <section class="section" id="sec-6">
            <div class="content-box" style="text-align: center; margin: auto;">
                <span class="label">Destination</span>
                <h1 c-font="yell_1">The Moon</h1>
                <p>Orbit established. Venturi FLEX rover deployment sequence armed. Exploring the dark side.</p>
            </div>
        </section>

    </div>

    <script>
        // Register GSAP plugins
        gsap.registerPlugin(ScrollTrigger);

        // --- PRELOADER ---
        const loaderEl = document.getElementById('loader');
        const loaderStatus = document.getElementById('loaderStatus');
        const loaderTime = document.getElementById('loaderTime');
        const scrollIndicator = document.getElementById('scrollIndicator');
        let timeLeft = 3.0; // Reduced to 3 seconds for better UX
        
        const timerInterval = setInterval(() => {
            timeLeft -= 0.1;
            if (timeLeft <= 0) {
                timeLeft = 0;
                clearInterval(timerInterval);
                launchSequence();
            }
            const seconds = Math.floor(timeLeft);
            const ms = Math.floor((timeLeft % 1) * 100);
            loaderTime.textContent = `00:${seconds.toString().padStart(2, '0')}:${ms.toString().padStart(2, '0')}`;
        }, 100);

        function launchSequence() {
            loaderStatus.classList.add('launching');
            
            // Show scroll indicator after a delay
            setTimeout(() => {
                scrollIndicator.classList.add('visible');
            }, 500);
            
            setTimeout(() => {
                loaderEl.classList.add('hidden');
                document.getElementById('globe-container').style.opacity = 1;
                initExperience();
            }, 1000);
        }

        // --- GLOBE SETUP ---
        const container = document.getElementById('globe-container');
        
        // Generate population data for hex bins
        const N = 800;
        const populationData = [...Array(N).keys()].map(() => ({
            lat: (Math.random() - 0.5) * 160,
            lng: (Math.random() - 0.5) * 360,
            pop: Math.random()
        }));

        // Create Earth Globe with realistic textures
        const earthGlobe = Globe()
            .globeImageUrl('https://unpkg.com/three-globe/example/img/earth-blue-marble.jpg')
            .bumpImageUrl('https://unpkg.com/three-globe/example/img/earth-topology.png')
            .backgroundImageUrl('https://unpkg.com/three-globe/example/img/night-sky.png')
            .showAtmosphere(true)
            .atmosphereColor('rgba(100, 150, 255, 0.8)')
            .atmosphereAltitude(0.25)
            .hexBinPointsData([])
            .hexBinPointWeight('pop')
            .hexBinResolution(4)
            .hexMargin(0.2)
            .hexTopColor(() => 'rgba(255, 53, 9, 0.9)')
            .hexSideColor(() => 'rgba(255, 53, 9, 0.6)')
            .hexAltitude(d => d.sumWeight * 0.1)
            (container);

        // Access Three.js internals
        const scene = earthGlobe.scene();
        const camera = earthGlobe.camera();
        const renderer = earthGlobe.renderer();
        const controls = earthGlobe.controls();

        // Disable default controls for scroll-driven animation
        controls.enableZoom = false;
        controls.enablePan = false;
        controls.enableRotate = false;
        controls.autoRotate = false;

        // Set initial camera position
        camera.position.set(0, 0, 450);

        // Configure renderer
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.setClearColor(0x040404);

        // Add custom lighting
        const THREE = window.THREE;
        
        // Orange accent light (Venturi style)
        const orangeLight = new THREE.PointLight(0xff3509, 1.5, 800);
        orangeLight.position.set(150, -100, 200);
        scene.add(orangeLight);

        // White fill light
        const fillLight = new THREE.DirectionalLight(0xffffff, 0.8);
        fillLight.position.set(100, 100, 200);
        scene.add(fillLight);

        // Create Satellite
        const satGroup = new THREE.Group();
        
        // Main body
        const satBody = new THREE.Mesh(
            new THREE.BoxGeometry(3, 3, 6),
            new THREE.MeshStandardMaterial({ color: 0xff3509, roughness: 0.3, metalness: 0.8 })
        );
        satGroup.add(satBody);

        // Solar panels
        const panelMat = new THREE.MeshStandardMaterial({ 
            color: 0x1a1a3a, 
            roughness: 0.2, 
            metalness: 0.9,
            side: THREE.DoubleSide
        });
        const leftPanel = new THREE.Mesh(new THREE.PlaneGeometry(15, 4), panelMat);
        leftPanel.position.set(-10, 0, 0);
        leftPanel.rotation.y = Math.PI / 2;
        satGroup.add(leftPanel);

        const rightPanel = new THREE.Mesh(new THREE.PlaneGeometry(15, 4), panelMat);
        rightPanel.position.set(10, 0, 0);
        rightPanel.rotation.y = Math.PI / 2;
        satGroup.add(rightPanel);

        // Antenna dish
        const dish = new THREE.Mesh(
            new THREE.ConeGeometry(2.5, 4, 16),
            new THREE.MeshStandardMaterial({ color: 0xdddddd, metalness: 0.7, roughness: 0.3 })
        );
        dish.position.set(0, 4, 0);
        satGroup.add(dish);

        satGroup.position.set(80, 50, 200);
        satGroup.rotation.set(0.3, 0.8, 0.2);
        scene.add(satGroup);

        // State tracking
        let currentPhase = 'earth';
        let hexDataVisible = false;

        // --- SCROLL ANIMATION ---
        function initExperience() {
            document.getElementById('mission-stats').classList.add('visible');
            document.getElementById('sec-1').classList.add('active');

            // Create a master timeline
            const masterTl = gsap.timeline({
                scrollTrigger: {
                    trigger: ".scroll-container",
                    start: "top top",
                    end: "bottom bottom",
                    scrub: 1.2,
                    onUpdate: (self) => {
                        updateHUD(self.progress);
                    }
                }
            });

            // Phase 1: Initial view
            masterTl.to(camera.position, {
                z: 280,
                duration: 2,
                ease: "power2.out",
                onStart: () => {
                    document.getElementById('hud').style.opacity = 1;
                }
            }, 0)
            .to(satGroup.position, {
                x: 40, y: 30, z: 150,
                duration: 2
            }, 0)
            .to(satGroup.rotation, {
                y: Math.PI * 0.5,
                duration: 2
            }, 0);

            // Phase 2: Earth rotation
            masterTl.to(camera.position, {
                x: 50, y: 40, z: 220,
                duration: 3,
                onStart: () => {
                    document.getElementById('sec-2').classList.add('active');
                }
            }, 2);

            // Phase 3: Show hex data
            masterTl.to({}, {
                duration: 0.5,
                onStart: () => {
                    document.getElementById('sec-3').classList.add('active');
                    document.getElementById('coord-display').innerText = "POPULATION DENSITY";
                    earthGlobe.hexBinPointsData(populationData);
                    hexDataVisible = true;
                }
            }, 5)
            .to(camera.position, {
                x: 30, y: 20, z: 200,
                duration: 2
            }, 5);

            // Phase 4: Zoom to Bangladesh
            masterTl.to({}, {
                duration: 0.5,
                onStart: () => {
                    document.getElementById('sec-4').classList.add('active');
                    document.getElementById('coord-display').innerText = "23.68° N, 90.35° E";
                    earthGlobe.hexBinPointsData([]);
                    hexDataVisible = false;
                    earthGlobe.pointOfView({ lat: 23.68, lng: 90.35, altitude: 0.8 }, 2000);
                }
            }, 8)
            .to(satGroup.position, {
                x: -30, y: 60, z: 140,
                duration: 2
            }, 8);

            // Phase 5: Transition to Moon
            masterTl.to({}, {
                duration: 0.5,
                onStart: () => {
                    document.getElementById('sec-5').classList.add('active');
                    document.getElementById('coord-display').innerText = "LUNAR TRANSFER";
                    currentPhase = 'transit';
                }
            }, 11)
            .to(camera.position, {
                z: 400,
                duration: 2
            }, 11)
            .to({}, {
                duration: 1,
                onStart: () => {
                    // Switch to Moon texture
                    earthGlobe
                        .globeImageUrl('https://unpkg.com/three-globe/example/img/moon.jpg')
                        .bumpImageUrl('https://unpkg.com/three-globe/example/img/moon-topology.png')
                        .showAtmosphere(false);
                    currentPhase = 'moon';
                }
            }, 12);

            // Phase 6: Moon orbit
            masterTl.to({}, {
                duration: 0.5,
                onStart: () => {
                    document.getElementById('sec-6').classList.add('active');
                    document.getElementById('coord-display').innerText = "SOUTH POLE AITKEN";
                    earthGlobe.pointOfView({ lat: -85, lng: 0, altitude: 1.5 }, 3000);
                }
            }, 14)
            .to(camera.position, {
                z: 280,
                duration: 3
            }, 14)
            .to(satGroup.position, {
                x: -40, y: -20, z: 160,
                duration: 3
            }, 14)
            .to(satGroup.rotation, {
                y: Math.PI * 2,
                z: 0.5,
                duration: 3
            }, 14);
        }

        // Update HUD based on scroll progress
        function updateHUD(progress) {
            const altitude = Math.round(400 - progress * 380 + (currentPhase === 'moon' ? 384400 : 0));
            const velocity = (7.66 + progress * 3.34).toFixed(2);
            
            document.getElementById('altitude-display').innerText = 
                currentPhase === 'moon' ? `ALT: ${altitude.toLocaleString()} KM` : `ALT: ${altitude} KM`;
            document.getElementById('velocity-display').innerText = `VEL: ${velocity} KM/S`;
            
            // Hide scroll indicator after some scrolling
            if (progress > 0.1) {
                scrollIndicator.classList.remove('visible');
            }
        }

        // Animate satellite
        function animateSatellite() {
            const time = Date.now() * 0.001;
            
            // Subtle floating motion
            satGroup.position.y += Math.sin(time * 0.5) * 0.02;
            satGroup.rotation.z = Math.sin(time * 0.3) * 0.1;
            
            // Rotate panels slightly
            satGroup.children.forEach((child, i) => {
                if (i > 0 && i < 3) { // Panels
                    child.rotation.z = Math.sin(time * 0.2) * 0.05;
                }
            });

            requestAnimationFrame(animateSatellite);
        }
        animateSatellite();

        // Handle resize
        window.addEventListener('resize', () => {
            earthGlobe.width(window.innerWidth);
            earthGlobe.height(window.innerHeight);
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
        });

        // Handle scroll to start animations
        window.addEventListener('wheel', () => {
            scrollIndicator.classList.remove('visible');
        }, { once: true });

    </script>
</body>
</html>
