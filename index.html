<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>Venturi Space | Mission Control</title>
    
    <!-- FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@300;400;500&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- GSAP (Global) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

    <style>
        :root {
            --bg-color: #040404;
            --text-color: #f4f4f4;
            --accent-color: #ff3509;
            --border-color: rgba(255, 255, 255, 0.2);
            --font-main: 'Barlow', sans-serif;
            --font-tech: 'Rajdhani', sans-serif;
            --ease-venturi: cubic-bezier(0.25, 0, 0.25, 1);
        }

        body {
            margin: 0; padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--font-main);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            transition: background-color 0.8s var(--ease-venturi);
        }

        /* --- LIGHT MODE --- */
        body.light-mode {
            --bg-color: #e5e5e5;
            --text-color: #111111;
            --border-color: rgba(0, 0, 0, 0.15);
        }
        body.light-mode #globe-container { opacity: 0.05; filter: grayscale(100%); }

        /* --- TYPOGRAPHY --- */
        [c-font="yell_1"] {
            font-family: var(--font-tech);
            font-size: clamp(4rem, 12vw, 14rem);
            line-height: 0.85;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: -0.02em;
        }

        [c-font="title_2"] {
            font-family: var(--font-tech);
            font-size: clamp(2rem, 5vw, 5rem);
            line-height: 1;
            text-transform: uppercase;
            font-weight: 600;
        }

        [c-font="label"] {
            font-family: var(--font-tech);
            font-size: 0.8rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--accent-color);
            border: 1px solid var(--accent-color);
            padding: 0.5em 1em;
            display: inline-block;
            margin-bottom: 2rem;
        }

        p { font-size: 1.1rem; line-height: 1.6; opacity: 0.8; max-width: 40ch; margin-top: 1.5rem; }

        /* --- HUD GRID (Rebuilt to match Image 2) --- */
        .hud-container {
            margin-top: 3rem;
            max-width: 600px;
            border-top: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
            display: grid;
            grid-template-columns: 1fr 1fr auto; /* 2 columns for data + 1 column for vertical status pills */
        }

        .hud-cell {
            padding: 1.5rem 2rem;
            border-right: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        /* Remove bottom border for last row to avoid double borders with container */
        .hud-cell:nth-child(n+4) { border-bottom: none; }
        
        /* The vertical status bar on the right */
        .hud-status-col {
            display: flex;
            flex-direction: column;
            border-left: 1px solid transparent; /* spacing fix */
        }
        
        .hud-status-item {
            flex: 1;
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            transform: rotate(180deg);
            font-family: var(--font-tech);
            font-size: 0.7rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            border-left: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
            opacity: 0.6;
        }
        .hud-status-item:last-child { border-bottom: none; }

        .hud-lbl { 
            font-size: 0.7rem; 
            opacity: 0.5; 
            letter-spacing: 0.1em; 
            text-transform: uppercase; 
            margin-bottom: 0.25rem;
            font-family: var(--font-main);
        }
        
        .hud-val { 
            font-family: var(--font-tech); 
            font-size: 2.2rem; 
            line-height: 1; 
            font-weight: 500; 
            display: block; 
        }
        
        .hud-unit {
            font-size: 0.9rem;
            margin-left: 0.2rem;
            opacity: 0.7;
        }

        /* --- PRELOADER --- */
        .loader {
            position: fixed; inset: 0; z-index: 9999;
            background: #040404;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: transform 1.2s var(--ease-venturi);
        }
        .loader.hidden { transform: translateY(-100%); }

        .loader-data {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            transition: opacity 0.5s var(--ease-venturi);
        }

        .loader-status {
            font-family: var(--font-tech);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 1.5em;
            overflow: hidden;
        }

        .loader-status span {
            display: block;
            transition: transform 0.5s var(--ease-venturi);
        }

        .loader-status.launching .loader-prepare { transform: translateY(-100%); }
        .loader-status.launching .loader-ready { transform: translateY(-100%); }

        .loader-countdown {
            display: flex;
            align-items: center;
            font-family: var(--font-tech);
            font-variant-numeric: tabular-nums;
        }

        .loader-bars {
            width: 3.9rem;
            margin-right: 1rem;
        }

        .loader-bar-group rect { 
            fill: rgba(255,255,255,0.2); 
            animation: pulse 0.8s infinite alternate; 
        }
        .loader-bar-group rect:nth-child(2) { animation-delay: 0.1s; }
        .loader-bar-group rect:nth-child(3) { animation-delay: 0.2s; }
        .loader-bar-group rect:nth-child(4) { animation-delay: 0.3s; }
        
        @keyframes pulse { 
            to { fill: var(--accent-color); } 
        }

        /* --- GLOBE CONTAINER --- */
        #globe-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1;
            opacity: 0;
            transition: opacity 2s var(--ease-venturi);
            pointer-events: none;
        }

        /* --- SCROLL SECTIONS --- */
        .scroll-container {
            position: relative;
            z-index: 10;
            min-height: 600vh;
        }

        .section {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 6rem 5vw;
            position: relative;
        }

        .layout-right { align-items: flex-end; text-align: right; }
        .layout-center { align-items: center; text-align: center; }

        /* Timeline Years */
        .year-row {
            display: flex; align-items: baseline; gap: 3rem;
            padding: 2rem 0; border-bottom: 1px solid var(--border-color);
        }
        .year { font-family: var(--font-tech); font-size: 5rem; line-height: 1; font-weight: 300; min-width: 200px; color: var(--accent-color); }
        .desc { font-size: 1.1rem; max-width: 400px; }

        /* Button */
        .btn-v {
            margin-top: 3rem;
            background: var(--accent-color);
            color: white;
            font-family: var(--font-tech);
            text-transform: uppercase;
            font-weight: 600;
            padding: 1rem 2rem;
            display: inline-flex;
            align-items: center;
            gap: 1rem;
            clip-path: polygon(0 0, 100% 0, 100% 70%, 90% 100%, 0 100%);
            transition: transform 0.3s ease;
            cursor: pointer;
            pointer-events: auto;
        }
        .btn-v:hover { transform: translateY(-5px); }

        /* NAV */
        nav {
            position: fixed; top: 0; width: 100%; padding: 2rem;
            display: flex; justify-content: space-between; z-index: 100;
            mix-blend-mode: difference; color: white;
            pointer-events: none;
        }
        nav > * { pointer-events: auto; }
        .logo { font-family: var(--font-tech); font-weight: 700; letter-spacing: 0.2em; font-size: 1.2rem; }

        /* Mobile adjustment for HUD */
        @media (max-width: 768px) {
            .hud-container { grid-template-columns: 1fr; }
            .hud-cell:nth-child(2) { border-right: none; }
            .hud-status-col { display: none; } /* Hide vertical bars on mobile */
        }
    </style>

    <!-- THREE.js and Globe.gl -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/globe.gl"></script>
</head>
<body>

    <!-- NAV -->
    <nav>
        <div class="logo">VENTURI SPACE</div>
        <div style="font-family: var(--font-tech); font-weight: 600; font-size: 0.9rem; background: white; color: black; padding: 0.5rem 1rem;">MENU</div>
    </nav>

    <!-- PRELOADER -->
    <div class="loader" id="loader">
        <div class="loader-data">
            <svg class="asset loader-logo" width="200" height="40" viewBox="0 0 200 40" xmlns="http://www.w3.org/2000/svg">
                <path d="M10,10 L30,30 L50,10" fill="none" stroke="white" stroke-width="4"/>
                <text x="60" y="28" fill="white" font-family="Rajdhani" font-size="18" font-weight="600">VENTURI SPACE</text>
            </svg>
            
            <div class="loader-status" id="loaderStatus">
                <span class="loader-prepare" c-font="body_3">Ready for launch</span>
                <span class="loader-ready" c-font="body_3">Take-off</span>
            </div>
            
            <div class="loader-countdown">
                <svg class="loader-bar-group" width="60" height="40">
                    <rect x="5" y="10" width="4" height="20" />
                    <rect x="15" y="5" width="4" height="30" />
                    <rect x="25" y="15" width="4" height="10" />
                    <rect x="35" y="0" width="4" height="40" />
                    <rect x="45" y="12" width="4" height="16" />
                </svg>
                <span class="loader-time" id="loaderTime">00:10:00</span>
            </div>
        </div>
    </div>

    <!-- GLOBE CONTAINER -->
    <div id="globe-container"></div>

    <!-- SCROLL CONTENT -->
    <div class="scroll-container">
        
        <!-- 1. INTRO (3D: Satellite in Deep Space) -->
        <section class="section" id="s1">
            <div style="margin-top: auto;">
                <div c-font="label">Phase 01</div>
                <h1 c-font="yell_1">Orbital<br>Injection</h1>
                <p>The Sentinel satellite stabilizes in high Earth orbit. Systems diagnostic complete. Establishing downlink.</p>
            </div>
        </section>

        <!-- 2. VENTURI HISTORY (Standard Layout / Light Mode) -->
        <section class="section" id="s2">
            <div style="max-width: 800px; margin: 0 auto; width: 100%;">
                <div c-font="label" style="margin-bottom: 4rem;">Legacy</div>
                
                <div class="year-row">
                    <div class="year">2000</div>
                    <div class="desc">Monegasque entrepreneur Gildo Pastor bought French carmaker Venturi.</div>
                </div>
                <div class="year-row">
                    <div class="year">26</div>
                    <div class="desc">World speed records with two and four wheel vehicles.</div>
                </div>
                <div class="year-row">
                    <div class="year">549</div>
                    <div class="desc">The Venturi VBB-3 is the fastest electric vehicle in history (km/h).</div>
                </div>
            </div>
        </section>

        <!-- 3. EARTH OBSERVATION (3D: Earth Globe) -->
        <section class="section layout-right" id="s3">
            <div style="max-width: 600px;">
                <div c-font="label">Global Scan</div>
                <h1 c-font="yell_1" style="font-size: clamp(3rem, 8vw, 8rem);">Earth<br>View</h1>
                <p style="margin-left: auto;">Visual contact established. Rotating sensors to Earth-facing vector. Population density map overlay active.</p>
                
                <!-- HUD GRID: EARTH VARIANT -->
                <div class="hud-container" style="margin-left: auto;">
                    <!-- Row 1 -->
                    <div class="hud-cell">
                        <span class="hud-lbl">ALTITUDE</span>
                        <span class="hud-val">400<span class="hud-unit">KM</span></span>
                    </div>
                    <div class="hud-cell">
                        <span class="hud-lbl">VELOCITY</span>
                        <span class="hud-val">7.66<span class="hud-unit">KM/S</span></span>
                    </div>
                    
                    <!-- Row 2 -->
                    <div class="hud-cell">
                        <span class="hud-lbl">INCLINATION</span>
                        <span class="hud-val">51.6<span class="hud-unit">DEG</span></span>
                    </div>
                    <div class="hud-cell">
                        <span class="hud-lbl">PERIOD</span>
                        <span class="hud-val">92.6<span class="hud-unit">MIN</span></span>
                    </div>

                    <!-- Vertical Status Column -->
                    <div class="hud-status-col">
                        <div class="hud-status-item">DAY 102</div>
                        <div class="hud-status-item">LEO</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4. ANALYSIS -->
        <section class="section" id="s4">
            <div class="content-box">
                <span class="label">Analysis</span>
                <h2 c-font="title_2">Population Density</h2>
                <p>Hex-bin aggregation reveals human activity clusters. Thermal signatures correlate with energy consumption.</p>
            </div>
        </section>

        <!-- 5. BANGLADESH ZOOM -->
        <section class="section layout-right" id="s5">
            <div style="max-width: 600px;">
                <div c-font="label">Target Acquired</div>
                <h1 c-font="title_2">Dhaka, Bangladesh</h1>
                <p>Precision coordinates locked. High-resolution scanning initiated at 23.68° N, 90.35° E.</p>
            </div>
        </section>

        <!-- 6. TRANSITION TEXT (Standard Layout) -->
        <section class="section layout-center" id="s6">
            <h1 c-font="title_2" style="max-width: 900px;">"Space has changed, but spacecraft haven't. We need a better vehicle for this modern domain."</h1>
            <div class="btn-v">Our Technology <span>→</span></div>
        </section>

        <!-- 7. MOON ARRIVAL (3D: Moon Globe) -->
        <section class="section" id="s7">
            <div>
                <h1 c-font="title_2">Exploring The<br>Lunar South Pole</h1>
                
                <!-- HUD GRID: MOON VARIANT (Matches Reference Image) -->
                <div class="hud-container">
                    <!-- Row 1 -->
                    <div class="hud-cell">
                        <span class="hud-lbl">DIAMETER ~</span>
                        <span class="hud-val">3 474<span class="hud-unit">KM</span></span>
                    </div>
                    <div class="hud-cell">
                        <span class="hud-lbl">GRAVITY</span>
                        <span class="hud-val">1.62<span class="hud-unit">m/s²</span></span>
                    </div>
                    
                    <!-- Row 2 -->
                    <div class="hud-cell">
                        <span class="hud-lbl">DENSITY</span>
                        <span class="hud-val">3 344<span class="hud-unit">kg/m³</span></span>
                    </div>
                    <div class="hud-cell">
                        <span class="hud-lbl">INCLINATION</span>
                        <span class="hud-val">6.68<span class="hud-unit">deg</span></span>
                    </div>

                    <!-- Vertical Status Column -->
                    <div class="hud-status-col">
                        <div class="hud-status-item">DAY 340</div>
                        <div class="hud-status-item">PHASE -3</div>
                    </div>
                </div>

                <p>Ice hidden deep in the craters. Exceptional levels of sunlight. The Moon's South Pole is a land of opportunity.</p>
                <div class="btn-v">Start Mission <span>→</span></div>
            </div>
        </section>

        <div style="height: 50vh;"></div>
    </div>

    <script>
        // Register GSAP plugins
        gsap.registerPlugin(ScrollTrigger);

        // --- PRELOADER ---
        const loaderEl = document.getElementById('loader');
        const loaderStatus = document.getElementById('loaderStatus');
        const loaderTime = document.getElementById('loaderTime');
        let timeLeft = 3.0; // Reduced to 3 seconds for better UX
        
        const timerInterval = setInterval(() => {
            timeLeft -= 0.1;
            if (timeLeft <= 0) {
                timeLeft = 0;
                clearInterval(timerInterval);
                launchSequence();
            }
            const seconds = Math.floor(timeLeft);
            const ms = Math.floor((timeLeft % 1) * 100);
            loaderTime.textContent = `00:${seconds.toString().padStart(2, '0')}:${ms.toString().padStart(2, '0')}`;
        }, 100);

        function launchSequence() {
            loaderStatus.classList.add('launching');
            
            setTimeout(() => {
                loaderEl.classList.add('hidden');
                document.getElementById('globe-container').style.opacity = 1;
                initExperience();
            }, 1000);
        }

        // --- GLOBE SETUP ---
        const container = document.getElementById('globe-container');
        
        // Generate population data for hex bins
        const N = 800;
        const populationData = [...Array(N).keys()].map(() => ({
            lat: (Math.random() - 0.5) * 160,
            lng: (Math.random() - 0.5) * 360,
            pop: Math.random()
        }));

        // Create Earth Globe with realistic textures
        const earthGlobe = Globe()
            .globeImageUrl('https://unpkg.com/three-globe/example/img/earth-blue-marble.jpg')
            .bumpImageUrl('https://unpkg.com/three-globe/example/img/earth-topology.png')
            .backgroundImageUrl('https://unpkg.com/three-globe/example/img/night-sky.png')
            .showAtmosphere(true)
            .atmosphereColor('rgba(60, 100, 255, 0.8)')
            .atmosphereAltitude(0.15)
            .hexBinPointsData([])
            .hexBinPointWeight('pop')
            .hexBinResolution(4)
            .hexMargin(0.2)
            .hexTopColor(() => '#ff3509')
            .hexSideColor(() => 'rgba(255, 53, 9, 0.6)')
            .hexAltitude(d => d.sumWeight * 0.1)
            (container);

        // Access Three.js internals
        const scene = earthGlobe.scene();
        const camera = earthGlobe.camera();
        const renderer = earthGlobe.renderer();
        const controls = earthGlobe.controls();

        // Disable default controls for scroll-driven animation
        controls.enableZoom = false;
        controls.enablePan = false;
        controls.enableRotate = false;
        controls.autoRotate = false;

        // Set initial camera position
        camera.position.set(0, 0, 450);

        // Configure renderer
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.setClearColor(0x040404);

        // Add custom lighting
        const THREE = window.THREE;
        
        // Orange accent light (Venturi style)
        const orangeLight = new THREE.PointLight(0xff3509, 1.5, 800);
        orangeLight.position.set(150, -100, 200);
        scene.add(orangeLight);

        // White fill light
        const fillLight = new THREE.DirectionalLight(0xffffff, 0.8);
        fillLight.position.set(100, 100, 200);
        scene.add(fillLight);

        // Create Satellite Group
        const satGroup = new THREE.Group();
        scene.add(satGroup);

        // Create a placeholder satellite (will be replaced by GLB if available)
        function createPlaceholderSatellite() {
            // Clear any existing children
            while(satGroup.children.length > 0) {
                satGroup.remove(satGroup.children[0]);
            }
            
            // Main body
            const satBody = new THREE.Mesh(
                new THREE.BoxGeometry(4, 4, 8),
                new THREE.MeshStandardMaterial({ color: 0xffaa00, roughness: 0.2, metalness: 0.9 })
            );
            satGroup.add(satBody);

            // Solar panels
            const panelMat = new THREE.MeshStandardMaterial({ 
                color: 0x111111, 
                roughness: 0.4, 
                metalness: 0.9,
                side: THREE.DoubleSide
            });
            const leftPanel = new THREE.Mesh(new THREE.PlaneGeometry(24, 6), panelMat);
            leftPanel.position.set(-12, 0, 0);
            leftPanel.rotation.y = Math.PI / 2;
            satGroup.add(leftPanel);

            const rightPanel = new THREE.Mesh(new THREE.PlaneGeometry(24, 6), panelMat);
            rightPanel.position.set(12, 0, 0);
            rightPanel.rotation.y = Math.PI / 2;
            satGroup.add(rightPanel);

            // Antenna dish
            const dish = new THREE.Mesh(
                new THREE.ConeGeometry(3, 5, 16),
                new THREE.MeshStandardMaterial({ color: 0xdddddd, metalness: 0.7, roughness: 0.3 })
            );
            dish.position.set(0, 5, 0);
            satGroup.add(dish);
        }

        // Load GLB satellite model if available
        function loadGLBSatellite() {
            // Create a GLTFLoader
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/loaders/GLTFLoader.js';
            script.onload = () => {
                const GLTFLoader = THREE.GLTFLoader || (window.THREE && window.THREE.GLTFLoader);
                if (GLTFLoader) {
                    const loader = new GLTFLoader();
                    // Try to load the sentinel.glb from assets folder
                    loader.load(
                        './assets/sentinel.glb',
                        (gltf) => {
                            console.log('Satellite GLB loaded successfully');
                            const model = gltf.scene;
                            
                            // Clear placeholder
                            while(satGroup.children.length > 0) {
                                satGroup.remove(satGroup.children[0]);
                            }
                            
                            // Scale and position the model
                            model.scale.set(5, 5, 5);
                            model.rotation.set(0, Math.PI, 0); // Adjust orientation if needed
                            
                            // Apply Venturi-style materials
                            model.traverse((child) => {
                                if (child.isMesh) {
                                    // Enhance materials for better appearance
                                    if (child.material) {
                                        child.material.metalness = 0.8;
                                        child.material.roughness = 0.3;
                                        
                                        // Apply Venturi orange to certain parts
                                        if (child.name.includes('body') || child.name.includes('main')) {
                                            child.material.color.set(0xffaa00);
                                        }
                                    }
                                }
                            });
                            
                            satGroup.add(model);
                        },
                        (xhr) => {
                            // Loading progress
                            console.log(`Satellite model loading: ${(xhr.loaded / xhr.total * 100)}%`);
                        },
                        (error) => {
                            console.error('Error loading satellite GLB:', error);
                            // Fallback to placeholder
                            createPlaceholderSatellite();
                        }
                    );
                } else {
                    console.log('GLTFLoader not available, using placeholder');
                    createPlaceholderSatellite();
                }
            };
            script.onerror = () => {
                console.log('Failed to load GLTFLoader, using placeholder');
                createPlaceholderSatellite();
            };
            document.head.appendChild(script);
        }

        // Initialize satellite
        loadGLBSatellite();

        // Set initial position
        satGroup.position.set(80, 50, 200);
        satGroup.rotation.set(0.3, 0.8, 0.2);

        // State tracking
        let currentPhase = 'earth';
        let hexDataVisible = false;

        // --- SCROLL ANIMATION ---
        function initExperience() {
            const masterTl = gsap.timeline({
                scrollTrigger: {
                    trigger: ".scroll-container",
                    start: "top top",
                    end: "bottom bottom",
                    scrub: 1.2,
                    onUpdate: (self) => {
                        updateHUD(self.progress);
                    }
                }
            });

            // SECTION 1: Initial view
            masterTl.to(camera.position, {
                z: 280,
                duration: 2,
                ease: "power2.out"
            }, 0)
            .to(satGroup.position, {
                x: 40, y: 30, z: 150,
                duration: 2
            }, 0)
            .to(satGroup.rotation, {
                y: Math.PI * 0.5,
                duration: 2
            }, 0);

            // SECTION 2: Light Mode / History
            masterTl.call(() => document.body.classList.add('light-mode'), null, 2)
            .to("#globe-container", { opacity: 0.1, duration: 1 }, 2);

            // SECTION 3: Dark Mode / Earth Observation
            masterTl.call(() => document.body.classList.remove('light-mode'), null, 4)
            .to("#globe-container", { opacity: 1, duration: 1 }, 4)
            .to(camera.position, {
                x: 50, y: 0, z: 220,
                duration: 3
            }, 4)
            .to(earthGlobe.rotation, {
                y: 2.5,
                duration: 3
            }, 4)
            .to(satGroup.position, {
                x: -40, y: 10, z: 120,
                duration: 3
            }, 4);

            // SECTION 4: Show population data
            masterTl.call(() => {
                earthGlobe.hexBinPointsData(populationData);
                hexDataVisible = true;
            }, null, 7);

            // SECTION 5: Zoom to Bangladesh
            masterTl.call(() => {
                earthGlobe.hexBinPointsData([]);
                hexDataVisible = false;
                earthGlobe.pointOfView({ lat: 23.68, lng: 90.35, altitude: 0.8 }, 2000);
            }, null, 9)
            .to(camera.position, {
                z: 180,
                duration: 2
            }, 9)
            .to(satGroup.position, {
                x: -30, y: 60, z: 140,
                duration: 2
            }, 9);

            // SECTION 6: Transition text (dim scene)
            masterTl.to("#globe-container", { opacity: 0.3, duration: 2 }, 11);

            // SECTION 7: Moon Reveal
            masterTl.call(() => {
                // Switch to Moon texture
                earthGlobe
                    .globeImageUrl('https://unpkg.com/three-globe/example/img/moon.jpg')
                    .bumpImageUrl('https://unpkg.com/three-globe/example/img/moon-topology.png')
                    .showAtmosphere(false);
                earthGlobe.pointOfView({ lat: -85, lng: 0, altitude: 1.5 }, 3000);
                currentPhase = 'moon';
            }, null, 13)
            .to("#globe-container", { opacity: 1, duration: 2 }, 13)
            .to(camera.position, {
                z: 280,
                duration: 3
            }, 13)
            .to(satGroup.position, {
                x: -40, y: -20, z: 160,
                duration: 3
            }, 13)
            .to(satGroup.rotation, {
                y: Math.PI * 2,
                z: 0.5,
                duration: 3
            }, 13);
        }

        // Update HUD based on scroll progress
        function updateHUD(progress) {
            const altitude = Math.round(400 - progress * 380 + (currentPhase === 'moon' ? 384400 : 0));
            const velocity = (7.66 + progress * 3.34).toFixed(2);
            
            // Update altitude display if HUD is present
            const altitudeElements = document.querySelectorAll('.hud-val');
            if (altitudeElements.length > 0) {
                // Update first HUD value (typically altitude)
                const altitudeDisplay = altitudeElements[0];
                altitudeDisplay.innerHTML = currentPhase === 'moon' ? 
                    `${altitude.toLocaleString()}<span class="hud-unit">KM</span>` : 
                    `${altitude}<span class="hud-unit">KM</span>`;
            }
        }

        // Animate satellite
        function animateSatellite() {
            const time = Date.now() * 0.001;
            
            // Subtle floating motion
            satGroup.position.y += Math.sin(time * 0.5) * 0.02;
            satGroup.rotation.y += 0.002;
            satGroup.rotation.z = Math.sin(time * 0.3) * 0.1;
            
            // Rotate panels if they exist
            satGroup.children.forEach((child) => {
                if (child.isMesh && child.geometry.type === 'PlaneGeometry') {
                    child.rotation.z = Math.sin(time * 0.2) * 0.05;
                }
            });

            requestAnimationFrame(animateSatellite);
        }
        animateSatellite();

        // Handle resize
        window.addEventListener('resize', () => {
            earthGlobe.width(window.innerWidth);
            earthGlobe.height(window.innerHeight);
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
        });

        // Initialize with placeholder while GLB loads
        createPlaceholderSatellite();

    </script>
</body>
</html>
